{% extends 'base.html' %}
{% load static %}
{% block title %}{{ cuisine_name|title }} Cuisine{% endblock %}

{% block content %}
  <h1>{{ cuisine_name|title }} Cuisine</h1>

  <div class="filters">
    <form method="get" class="category-sort">
      <label>Category:</label>
      <select name="category" onchange="this.form.submit()">
        <option value="">All</option>
        <option value="vegetarian" {% if selected_category == "vegetarian" %}selected{% endif %}>Vegetarian</option>
        <option value="vegan" {% if selected_category == "vegan" %}selected{% endif %}>Vegan</option>
        <option value="diet" {% if selected_category == "diet" %}selected{% endif %}>Diet</option>
        <option value="gluten_free" {% if selected_category == "gluten_free" %}selected{% endif %}>Gluten-Free</option>
      </select>

      <label>Sort by:</label>
      <select name="sort" onchange="this.form.submit()">
        <option value="">None</option>
        <option value="difficulty_asc" {% if request.GET.sort == "difficulty_asc" %}selected{% endif %}>Difficulty ↑</option>
        <option value="difficulty_desc" {% if request.GET.sort == "difficulty_desc" %}selected{% endif %}>Difficulty ↓</option>
        <option value="calories_asc" {% if request.GET.sort == "calories_asc" %}selected{% endif %}>Calories ↑</option>
        <option value="calories_desc" {% if request.GET.sort == "calories_desc" %}selected{% endif %}>Calories ↓</option>
      </select>
    </form>
  </div>

  <div class="recipes-grid">
    {% for recipe in recipes %}
      <div class="recipe-card">
        <a href="{% url 'recipe_detail' recipe.pk %}">
          {% if recipe.image %}
            <img src="{{ recipe.image.url }}" alt="{{ recipe.name }}">
          {% else %}
            <img src="{% static 'placeholder.jpg' %}" alt="No image">
          {% endif %}
          <h2>{{ recipe.name }}</h2>
          <p>Calories: {{ recipe.calories }}</p>
          <p>Difficulty:
            {% for i in "12345" %}
              {% if forloop.counter <= recipe.difficulty %}★{% else %}☆{% endif %}
            {% endfor %}
          </p>
        </a>
      </div>
    {% empty %}
      <p>No recipes found.</p>
    {% endfor %}
  </div>
{% endblock %}
